{% extends "auctions/layout.html" %}

{% block body %}

    <style>
        .section{
            display: grid;
            border: 3px solid black;
            height: auto;
            padding: 30px;
            margin: 20px;
        }

        img{
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 50%;
            height: auto;
            padding: 40px;
        }
    </style>

    <h3>Listing: <i>{{auctions.title}}</i></h3>

    <img src = {{auctions.image}} alt = "Image"} >
    <hr>
    <strong>Description:</strong>
    <br><br>
    <p>{{auctions.description}}</p>
    <hr>
    <h5>Current Bid: ${{bidAuction.currentBid}}</h5>
    {% if user.is_authenticated %}

        {% if auctions.closed == False%}

            {% if user.username != auctions.username %}

                <form style="padding: 10px;"action = "{% url 'bid' auctions.id %}" method = "post">
                    {% csrf_token %}
                    <input autofocus class="form-control" type="number" step = "0.01" min = {{bidAuction.currentBid}} name="newbid" placeholder="Place your bid" required>
                    <br>
                    <input type="submit" value = "Place bid">
                </form>
            {% else %}

                <form style="padding: 10px;"action = "{% url 'closedAuction'%}" method = "post">
                    {% csrf_token %}
                    <input type="hidden" name = "auction_id" value = {{auctions.id}}>
                    <input type="submit" class="btn btn-danger" value = "Close Auction">
                </form>

            {% endif %}

        {% else %}
            <div class="alert alert-success" role="alert">
                {{bidAuction.currentBidder}} has succesfully won the auction.
            </div>
        {% endif %}
        <form style="padding: 10px;" method = "post" action = "{% url 'watchlist'%}">
            {% csrf_token %}
            <input type = "hidden" name = "auction_id" value = {{auctions.id}}>
            {% if inWatchList%}
                <input class="btn btn-danger" type="submit" value="Remove from Watchlist">
            {% else %}
                <input class="btn btn-success" type="submit" value="Add to Watchlist">
            {% endif %}
        </form>
        <br><hr>
        <h4>Comments</h4>
        {% for comment in comments%}
            <div class = "section">
                {{comment.comment}}
                <hr>
                <p style = "font-size: 15px; color: #8D8DAA;"><i>{{comment.username}}</i></p>
            </div>
        {% endfor %}

        <form method = "post" action = "{% url 'comments' auctions.id %}">
            {% csrf_token %}
            <div class="form-group">
                <textarea autocomplete = "off" class="form-control" style = "height: 150px;" name="comment" placeholder="Enter description" required></textarea>
            </div>
            <input type="submit" value = "Add comment">

        </form>

    {% endif %}

{% endblock %}